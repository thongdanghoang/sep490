<h1 class="font-bold text-lg">{{ "enterprise.Users.title" | translate }}</h1>
<p class="font-light">{{ "enterprise.Users.description" | translate }}</p>
<table-template
    *ngIf="!applicationService.isMobile()"
    [fetch]="fetchUsers"
    [columns]="cols"
    [sort]="undefined"
    [criteria]="searchCriteria"
    [triggerSearch]="searchEvent"
    [captionTemplateRef]="captionTemplateRef"
    [checkbox]="true"
    (selectionChange)="onSelectionChange($event)"
>
</table-template>
<ng-template #captionTemplateRef>
    <div class="flex items-center justify-between">
        <div class="flex gap-2.5">
            <p-iconfield>
                <p-inputicon styleClass="pi pi-search" />
                <input
                    [(ngModel)]="searchCriteria.criteria"
                    type="text"
                    pInputText
                    placeholder="Search"
                    (keydown.enter)="search()"
                />
            </p-iconfield>
            <p-button
                severity="primary"
                [label]="'enterprise.Users.search' | translate"
                icon="pi pi-user-plus"
                outlined
                (onClick)="search()"
            />
        </div>
        <div class="flex gap-2.5">
            <p-button
                severity="danger"
                [label]="
                    selected.length
                        ? ('enterprise.Users.deleteWithCount'
                          | translate: { count: selected.length })
                        : ('enterprise.Users.delete' | translate)
                "
                icon="pi pi-trash"
                outlined
                [disabled]="!selected || !selected.length"
                (onClick)="confirmDelete()"
            />
            <a
                class="p-button font-bold"
                [routerLink]="[
                    '/',
                    AppRoutingConstants.AUTH_PATH,
                    AppRoutingConstants.USER_DETAILS,
                ]"
            >
                <i class="pi pi-user-plus"></i>
                {{ "enterprise.Users.add" | translate }}
            </a>
        </div>
    </div>
</ng-template>
<ng-template #actionsTemplate let-rowData>
    <div class="flex">
        <p-button
            icon="pi pi-pencil"
            [rounded]="true"
            [text]="true"
            severity="info"
            (onClick)="onEdit(rowData)"
        />
        <p-button
            icon="pi pi-trash"
            [rounded]="true"
            [text]="true"
            severity="danger"
            (onClick)="onDelete(rowData)"
        />
    </div>
</ng-template>
<ng-template #permissionTemplate let-rowData>
    <p>
        <span *ngFor="let p of rowData.buildingPermissions">
            {{ "enum.permissionRole." + p.role | translate }}
        </span>
        <!-- TODO: solve dupplication since user can have: STAFF, STAFF, STAFF, AUDITOR -->
    </p>
</ng-template>
<ng-template #scopeTemplate let-rowData>
    <p>{{ "enum.scope." + rowData.scope | translate }}</p>
</ng-template>
